phases_data:
    definitions:
        _sandboxClasses:
        -   description: ディレクトリツリーの中間オブジェクト、 プロビジョニング用のテンプレートオブジェクト、システム連携時の認証用オブジェクトなどのクラス
            displayName: LDAP汎用オブジェクト
            isNestedObject: false
            isPrimaryAndNestedObject: false
            keyProperty: dn
            name: LdapGenericObject
            outputLdapSchema: false
            propertyDefinitionList:
            -   allowAnotherValue: false
                description: LDAPのディレクトリーツリー内での位置を示す識別子
                displayName: DN
                isArray: false
                maxLen: 1024
                minLen: 1
                name: dn
                outputLdapSchema: false
                required: true
                type: string
                unique: true
                uniqueIgnoreCase: true
            -   allowAnotherValue: false
                description: LDAPのオブジェクトクラス
                displayName: オブジェクトクラス
                isArray: true
                maxLen: 1024
                minLen: 1
                name: objectClass
                outputLdapSchema: false
                required: false
                stringRestriction: id
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ドメインコンポーネント
                displayName: DC
                isArray: false
                maxLen: 256
                minLen: 1
                name: dc
                outputLdapSchema: false
                required: false
                stringRestriction: id
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: 一般名称
                displayName: CN
                isArray: false
                maxLen: 256
                minLen: 1
                name: cn
                outputLdapSchema: false
                required: false
                stringRestriction: id
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: 姓
                displayName: SN
                isArray: false
                maxLen: 256
                minLen: 1
                name: sn
                outputLdapSchema: false
                required: false
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: 組織単位
                displayName: OU
                isArray: false
                maxLen: 256
                minLen: 1
                name: ou
                outputLdapSchema: false
                required: false
                stringRestriction: id
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ユーザのパスワード
                displayName: パスワード
                encryption: ARGON2
                isArray: false
                name: userPassword
                outputLdapSchema: false
                required: false
                stringRestriction: password
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ユーザID
                displayName: UID
                isArray: false
                maxLen: 256
                minLen: 1
                name: uid
                outputLdapSchema: false
                required: false
                stringRestriction: id
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                displayName: オブジェクトレベル
                isArray: false
                name: level
                outputLdapSchema: false
                required: false
                type: number
                unique: false
                uniqueIgnoreCase: false
        -   description: システムの利用者のクラス
            displayName: 利用者
            isNestedObject: false
            isPrimaryAndNestedObject: false
            keyProperty: uid
            ldapSuperClass: person
            name: user
            outputLdapSchema: true
            propertyDefinitionList:
            -   allowAnotherValue: false
                description: ユーザを識別する一意の ID
                displayName: ユーザID
                isArray: false
                maxLen: 64
                minLen: 1
                name: uid
                outputLdapSchema: false
                patternForInput: ^[a-z0-9_-]+$
                propagations:
                -   targetProperty: dn
                required: true
                stringRestriction: id
                type: string
                unique: true
                uniqueIgnoreCase: true
            -   allowAnotherValue: false
                description: ユーザの姓
                displayName: 姓
                isArray: false
                maxLen: 256
                minLen: 1
                name: sn
                outputLdapSchema: false
                required: true
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ユーザの名
                displayName: 名
                isArray: false
                maxLen: 256
                minLen: 1
                name: cn
                outputLdapSchema: false
                required: true
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ユーザのメールアドレス
                displayName: メールアドレス
                isArray: false
                name: mailAddress
                outputLdapSchema: false
                required: true
                stringRestriction: mailaddr
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                description: ユーザがID管理業務上割り当てられた役割
                displayName: ID管理役割
                isArray: false
                name: idmRole
                outputLdapSchema: true
                required: false
                type: string
                unique: false
                uniqueIgnoreCase: false
                values:
                -   displayName: 全権管理者
                    value: IDM_ADMIN
                -   displayName: 管理者
                    value: IDM_USER_ADMIN
                -   displayName: 業務管理者
                    value: IDM_USER_LEADER
                -   displayName: 利用者
                    value: IDM_USER
            -   allowAnotherValue: false
                description: ユーザのパスワード
                displayName: パスワード
                encryption: ARGON2
                isArray: false
                name: userPassword
                outputLdapSchema: false
                required: false
                type: string
                unique: false
                uniqueIgnoreCase: false
            -   allowAnotherValue: false
                derivation: '"uid=" + this().uid + ",OU=Users,{{ dn_suffix }}"'
                description: LDAPのディレクトリーツリー内での位置を示す識別子
                displayName: DN
                isArray: false
                name: dn
                outputLdapSchema: true
                required: false
                type: string
                unique: false
                uniqueIgnoreCase: false
        _sandboxGadgets:
        -   autoCommit: false
            backToDetail: false
            className: LdapGenericObject
            clonable: false
            description: LDAP汎用オブジェクトを編集するガジェット
            disableAdd: false
            disableDelete: false
            disableMultiDelete: false
            disableUpdate: false
            displayName: LDAP汎用オブジェクト編集ガジェット
            downloadDisplayFormatCSV: false
            downloadUpdateFormatCSV: true
            interfaceName: LdapGenericObjectEditorIF
            isSingleton: false
            name: LdapGenericObjectEditor
            showHistory: false
            uploadCSV: true
            useDisplayNameHeader: false
            withHeader: true
        -   autoCommit: false
            backToDetail: false
            className: user
            clonable: false
            disableAdd: false
            disableDelete: false
            disableMultiDelete: false
            disableSuspension: false
            disableUpdate: false
            displayName: ユーザ編集
            downloadDisplayFormatCSV: false
            downloadUpdateFormatCSV: false
            interfaceName: userEditorInterface
            isSingleton: false
            name: userEditor
            showHistory: false
            uploadCSV: false
            useDisplayNameHeader: false
            withHeader: true
        _sandboxInterfaces:
        -   accessLevel: full
            className: LdapGenericObject
            database: Sandbox
            deleteAsUpdate: false
            description: LDAP汎用オブジェクトを編集するインタフェース
            displayName: LDAP汎用オブジェクト編集IF
            name: LdapGenericObjectEditorIF
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        -   accessLevel: full
            className: LdapGenericObject
            database: Sandbox
            deleteAsUpdate: false
            description: "LDAP汎用オブジェクトの初期設定用インタフェース\r\nLevel 毎に分割してプロビジョニングを行う\r\nLevel
                0 のオブジェクトを更新する"
            displayName: LDAP汎用オブジェクト編集IF0
            filterDerivation: '{level: 0}'
            name: LdapGenericObjectEditorIF0
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        -   accessLevel: full
            className: LdapGenericObject
            database: Sandbox
            deleteAsUpdate: false
            description: "LDAP汎用オブジェクトの初期設定用インタフェース\r\nLevel 毎に分割してプロビジョニングを行う\r\nLevel
                1 のオブジェクトを更新する"
            displayName: LDAP汎用オブジェクト編集IF1
            filterDerivation: '{level: 1}'
            name: LdapGenericObjectEditorIF1
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        -   accessLevel: full
            className: LdapGenericObject
            database: Sandbox
            deleteAsUpdate: false
            description: "LDAP汎用オブジェクトの初期設定用インタフェース\r\nLevel 毎に分割してプロビジョニングを行う\r\nLevel
                2 のオブジェクトを更新する"
            displayName: LDAP汎用オブジェクト編集IF2
            filterDerivation: '{level: 2}'
            name: LdapGenericObjectEditorIF2
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        -   accessLevel: readWrite
            className: user
            database: Sandbox
            deleteAsUpdate: false
            description: パスワード変更サーブレットが使用するインタフェース
            displayName: パスワード変更IF
            initializer:
            -   conditionEx: 'true'
                derivation: '(date = Date(Date().getTime() + (24 * 3600 * 1000 * ((sys
                    = getResource("/IDManager/_masterSystemSettings/SystemSetting"))
                    ? sys.pwAvailableDays : 180)))) ? date.getFullYear() + "-" + (date.getMonth()
                    + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1)
                    + "-" + (date.getDate() < 10 ? "0" + date.getDate() : date.getDate())
                    : null'
                onDeleteOnly: false
                targetProperty: expireDate
            name: changePassword
            properties:
            - uid
            - userPassword
            - mailAddress
            - sn
            - cn
            propertyNameMapping:
            -   destinationProperty: password
                sourceProperty: userPassword
            -   destinationProperty: mail
                sourceProperty: mailAddress
            -   destinationProperty: param1
                sourceProperty: sn
            readOnlyProperties:
            - uid
            - mailAddress
            - sn
            - cn
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        -   accessLevel: full
            className: user
            database: Sandbox
            deleteAsUpdate: false
            description: ユーザ情報を編集するインタフェース
            displayName: ユーザ情報編集インタフェース
            name: userEditorInterface
            useAESDecryptedResponse: false
            useCustomBackendDatabase: false
        _sandboxProvSettings:
        -   appendOnly: false
            classSetting:
            -   className: LdapGenericObject
                noDecryption: false
                properties:
                -   modifiedOnly: false
                    propertyName: dn
                -   modifiedOnly: false
                    propertyName: objectClass
                -   modifiedOnly: false
                    propertyName: dc
                -   modifiedOnly: false
                    propertyName: cn
                -   modifiedOnly: false
                    propertyName: sn
                -   modifiedOnly: false
                    propertyName: ou
                -   modifiedOnly: false
                    propertyName: userPassword
                -   modifiedOnly: false
                    propertyName: uid
                type: LDAP
            database: Master
            description: LDAP汎用オブジェクトのプロビジョニング
            displayName: LDAP汎用オブジェクトプロビジョニング
            host: 'ldap '
            ignore: false
            ignoreMultiResult: false
            ignoreZeroResult: false
            loginname: cn=Manager,{{ dn_suffix }}
            name: LdapGenericObjectProvisioning
            outputAll: false
            password: '{{ db_password }}'
            stop: false
            type: LDAP
            withHeader: false
        -   appendOnly: false
            classSetting:
            -   className: user
                noDecryption: false
                properties:
                -   modifiedOnly: false
                    propertyName: uid
                -   modifiedOnly: false
                    propertyName: sn
                -   modifiedOnly: false
                    propertyName: cn
                -   modifiedOnly: false
                    propertyName: userPassword
                -   modifiedOnly: false
                    propertyName: dn
                -   modifiedOnly: false
                    propertyName: idmRole
                -   modifiedOnly: false
                    propertyName: accountLock
                templateDn: cn=TemplateOfUser,ou=SystemObjects,{{ dn_suffix }}
                type: LDAP
            database: Master
            description: ユーザ情報のプロビジョニング
            displayName: ユーザ情報プロビジョニング
            host: 'ldap '
            ignore: false
            ignoreMultiResult: false
            ignoreZeroResult: false
            loginname: cn=Manager,{{ dn_suffix }}
            name: LdapUserProvisioning
            outputAll: false
            password: '{{ db_password }}'
            stop: false
            type: LDAP
            withHeader: false
        _sandboxSystemSettings:
        -   adminRoles:
            - IDM_ADMIN
            authType: none
            csvApiFileEncoding: UTF-8
            name: SystemSetting
            passphrase: P@ssw0rd123
            pwAvailableDays: 0
            pwChangeMessageDay: 0
            pwNotWaitTaskCompletion: false
            pwPermitSameValue: false
            pwTrustedSites:
            - ^https://auth.{{ domain }}
            - ^https://idm3.{{ domain }}
            - ^http://localhost
            pwUseQuestion: false
            pwUserIf: changePassword
            pwpolicyAlphaCnt: 1
            pwpolicyMaxLen: 64
            pwpolicyMinLen: 12
            pwpolicyNumSymbolCnt: 1
            pwpolicySymbolChars: '!"#$%&''()=~|¥^-@[]:;+*_?><,./'
            systemName: 特権ID管理システム
            traceFormula: false
    layouts:
        _sandboxNavbar:
        -   component:
            -   align: left
                priority: 1
                type: logo
            -   align: left
                displayName: ベース設定
                priority: 10
                sidebarName: baseSidebar
                type: sidebar
            -   align: left
                displayName: レイアウト設定
                priority: 20
                sidebarName: layoutSidebar
                type: sidebar
            -   align: left
                displayName: 認証設定
                priority: 30
                sidebarName: userSidebar
                type: sidebar
            -   align: right
                priority: 10
                type: username
            -   align: right
                priority: 20
                type: userProv
            -   align: right
                priority: 30
                type: language
            -   align: right
                priority: 40
                type: reload
            name: adminNavbar
        -   component:
            -   align: right
                priority: 10
                type: username
            -   align: right
                priority: 20
                type: reload
            name: defaultNavbar
        _sandboxRoles:
        -   httpHeader: HTTP_REMOTEGROUP
            name: adminRole
            navbar: adminNavbar
            priority: 10
            testRegex: (^|.*;) *IDM_ADMIN *(;.*|$)
        -   httpHeader: HTTP_REMOTEGROUP
            name: defaultRole
            navbar: defaultNavbar
            priority: 100
            testRegex: .*
        _sandboxSidebar:
        -   children:
            -   children:
                -   displayName: クラス編集
                    gadgetName: _sandboxClassEditor
                    type: gadget
                -   displayName: インタフェース編集
                    gadgetName: _sandboxInterfaceEditor
                    type: gadget
                -   displayName: ガジェット編集
                    gadgetName: _sandboxGadgetEditor
                    type: gadget
                -   displayName: 翻訳テーブル編集
                    gadgetName: _sandboxTranslatorEditor
                    type: gadget
                -   displayName: インポート設定
                    gadgetName: _sandboxImportSettingsEditor
                    type: gadget
                -   displayName: システム設定
                    gadgetName: _systemSettingEditor
                    type: gadget
                -   displayName: 自動更新バッチ編集
                    gadgetName: _sandboxUpdateBatchEditor
                    type: gadget
                displayName: ベース設定
                type: parent
            -   children:
                -   displayName: プロビジョニング設定
                    gadgetName: _sandboxProvSettingEditor
                    type: gadget
                -   displayName: 要求閲覧
                    gadgetName: _provRequestViewer
                    type: gadget
                -   displayName: タスク閲覧
                    gadgetName: _taskViewer
                    type: gadget
                -   displayName: タスクログ閲覧
                    gadgetName: _taskLogViewer
                    type: gadget
                displayName: プロビジョニング設定
                type: parent
            name: baseSidebar
        -   children:
            -   displayName: 役割編集
                gadgetName: _sandboxRoleEditor
                icon: M25 24a8 8 0 100-16 8 8 0 000 16zm-14 4a6 6 0 100-12 6 6 0 000
                    12zm28 0a6 6 0 100-12 6 6 0 000 12zM25 30c-5.3 0-10 2.7-10 6v4h20v-4c0-3.3-4.7-6-10-6zM11
                    30c-4.4 0-8 2.2-8 5v3h16v-3c0-2.8-3.6-5-8-5zm28 0c-4.4 0-8 2.2-8
                    5v3h16v-3c0-2.8-3.6-5-8-5z
                type: gadget
            -   displayName: ナビゲーションバー編集
                gadgetName: _sandboxNavbarEditor
                icon: M3 5h44v10H3z
                type: gadget
            -   displayName: サイドバー編集
                gadgetName: _sandboxSidebarEditor
                icon: M3 5h12v40H3z M19 15h28v4H19z M19 25h28v4H19z M19 35h28v4H19z
                type: gadget
            name: layoutSidebar
        -   children:
            -   displayName: ユーザ設定
                gadgetName: userEditor
                type: gadget
            -   displayName: LDAP汎用オブジェクト
                gadgetName: LdapGenericObjectEditor
                type: gadget
            -   displayName: OpenLDAPデータベース設定
                gadgetName: _openLdapDbSettingEditor
                type: gadget
            -   displayName: パスワード変更
                redirectUrl: https://idm3.{{ domain }}/changePassword/changePassword?returnURL=https://idm3.{{
                    domain }}/
                type: link
            -   displayName: ログアウト
                icon: M30 10 L30 15 L40 15 L40 35 L30 35 L30 40 L45 40 L45 10 Z M20
                    18 L25 22.5 L18 22.5 L18 27.5 L25 27.5 L20 32 L5 25 Z
                redirectUrl: https://idm3.{{ domain }}/Shibboleth.sso/Logout?return=https://auth.{{
                    domain }}/idp/profile/Logout
                type: link
            name: userSidebar
    ldap_settings:
        _sandboxOpenLdapDbSetting:
        -   acl:
            -   attrs:
                - userPassword
                - shadowLastChange
                childrenFlag: false
                entryFlag: false
                rule:
                -   level: auth
                    who: anonymous
                -   level: none
            -   childrenFlag: false
                entryFlag: false
                rule:
                -   level: read
                    who: self
                -   level: none
            dbDirectory: /var/lib/openldap/openldap-data
            description: ユーザ認証に用いるLDAP
            displayName: 認証用LDAP
            dnSuffix: '{{ dn_suffix }}'
            indexedAttribute:
            - uid
            number: 1
            rootDN: cn=Manager,{{ dn_suffix }}
            rootPW: '{{ db_password }}'
        _sandboxProvSettings:
        -   appendOnly: false
            classSetting:
            -   className: _openLdapDbSetting
                noDecryption: false
                type: OpenLDAPDB
            database: Repository
            description: 認証用LDAPへのDB設定のプロビジョニング
            displayName: 認証用LDAPDBプロビジョニング
            host: 'ldap '
            ignore: false
            ignoreMultiResult: false
            ignoreZeroResult: false
            loginname: cn=config
            name: LdapDBProvisioning
            outputAll: false
            password: '{{ credentials.ldap_config_password }}'
            stop: false
            type: OpenLDAPDB
            withHeader: false
        -   appendOnly: false
            classSetting:
            -   className: _classDefinition
                noDecryption: false
                type: OpenLDAPSchema
            database: Repository
            description: 認証用LDAPへのスキーマのプロビジョニング
            displayName: 認証用LDAPスキーマプロビジョニング
            host: 'ldap '
            ignore: false
            ignoreMultiResult: false
            ignoreZeroResult: false
            loginname: cn=config
            name: LdapSchemaProvisioning
            outputAll: false
            password: '{{ credentials.ldap_config_password }}'
            stop: false
            type: OpenLDAPSchema
            withHeader: false
    master_tables:
        LdapGenericObjectEditorIF0:
        -   dc: '{{ dn_suffix | regex_replace(''^DC=([^,]*),.*$'', ''\1'') }}'
            dn: '{{ dn_suffix }}'
            level: 0
            objectClass:
            - locality
            - dcObject
        LdapGenericObjectEditorIF1:
        -   dn: ou=SystemObjects,{{ dn_suffix }}
            level: 1
            objectClass:
            - organizationalUnit
            ou: SystemObjects
        -   dn: ou=Users,{{ dn_suffix }}
            level: 1
            objectClass:
            - organizationalUnit
            ou: Users
        LdapGenericObjectEditorIF2:
        -   cn: TemplateOfUser
            dn: cn=TemplateOfUser,ou=SystemObjects,{{ dn_suffix }}
            level: 2
            objectClass:
            - user
            - uidObject
            sn: dummy
            uid: TemplateOfUser
    objects:
        userEditorInterface:
        -   cn: admin
            dn: uid=admin,OU=Users,{{ dn_suffix }}
            idmRole: IDM_ADMIN
            mailAddress: admin@example.com
            sn: idm
            uid: admin
            userPassword: '{ARGON2}$argon2id$v=19$m=65536,t=3,p=4$pYsQjR2kdf456Jt6QSc2BQ$Lw17E4tNKJ6Y1wCQivfOfeLXQvBM28u/cMlZTvZuLlk'
